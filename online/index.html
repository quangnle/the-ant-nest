<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Bug Farm</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Chakra+Petch:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Nunito:wght@400;700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="./assets/styles/index.css">
  <link rel="stylesheet" href="./assets/login-box.css">

</head>

<body>
  <div class="game">
    <div class="player-info border-wrapper">
      <div class="header"><span data-stat="player" style="margin-right: 2px;"></span></div>
      <p>Money: <span data-stat="money" style="margin-right: 2px;">$0</span></p>
      <p>Capacity: <span data-stat="capacity" style="margin-right: 2px;">0</span></p>
      <p>Flowers: <span data-stat="flowers" style="margin-right: 2px;">0</span></p>
      <p>Population: <span data-stat="population" style="margin-right: 2px;">0</span></p>

      <button id="myBtn" class="btn">Create pattern</button>
      <button class="btn board-toggle">Bug List</button>
    </div>
    <div name="game-area" class="game-area">
      <div id="sketch-holder" class="sketch-holder">
        <div class="main-canvas__wrapper border-wrapper">
          <canvas id="main-canvas"></canvas>
          <div class="mode" data-mode="play">
            <label class="btn">
              <input type="radio" name="mode-switch" id="mode-play" value="play" />
              <span>Play</span>
            </label>

            <label class="btn">
              <input type="radio" name="mode-switch" id="mode-plant" value="plant" />
              <span>Plant</span>
            </label>
          </div>
        </div>
        <div class="auth-overlay">
          <form class="login-box">
            <input name="username" class="input" placeholder="Enter your ID" value="test" autofocus="true" />
            <input name="password" class="input" placeholder="Enter your password" value="12345678" />
            <div class="actions">
              <button type="submit" class="login-box__login btn">Login</button>
              <button class="login-box__signup btn">Register</button>
            </div>
          </form>
          <div class="tank-list"></div>
        </div>
      </div>

      <div class="control-area">
        <div class="target-object border-wrapper">
          <div class="target-zoom">
            <div class="border-wrapper border-2">
              <canvas id="object-render-canvas" width="50" height="50"></canvas>
            </div>
            <div class="border-wrapper border-2"><canvas id="bug-pattern-canvas" width="50" height="50"></canvas>
            </div>

          </div>

          <div class="target-info">
            <div id="object-info" readonly rows="10" cols="20"></div>

            <div class="target-control">
              <div id="btn-sell-it" class="btn" onclick="handleSellBug()">Sell
                it</div>
              <div id="btn-bring-to-market" class="btn">To Market</div>
              <div id="btn-remove-it" class="btn" onclick="handleRemoveFlower()">Remove
                it</div>
            </div>
          </div>
        </div>
        <div class="flower-seed border-wrapper">
          <div class="header">Flower Seed</div>
          <div class=" control-section--flower">
            <ul style="list-style-type: none; padding: 5px;">
              <li>Number of petals: <input type="number" id="petal-number" value="5" min="5" max="8"
                  style="width: 25px;">
              </li>
              <li>
                <ul style="list-style-type: none; padding: 3px;">
                  <li style="display: inline;">Pistil Color: <input type="color" id="pistil-color" value="#ff0000"
                      style="width: 35px;"></li>
                  <li style="display: inline;">Size: <input type="number" id="pistil-size" value="5" min="3" max="7"
                      style="width: 25px;"></li>
                </ul>
              </li>
              <li>
                <ul style="list-style-type: none; padding: 3px;">
                  <li style="display: inline;">Petal Color: <input type="color" id="petal-color" value="#ffffff"
                      style="width: 35px;"></li>
                  <li style="display: inline;">Size: <input type="number" id="petal-size" value="5" min="3" max="7"
                      style="width: 25px;"></li>
                </ul>
              </li>
              <li>Right-click in Plant Mode for plating flower</li>
            </ul>
          </div>

          <button id="btn-show" onclick="show()" class="btn">Marching Show!!!</button>
        </div>
      </div>
    </div>
  </div>

  <!-- The Modal -->
  <div id="myModal" class="modal">
    <!-- Modal content -->
    <div class="modal-content border-wrapper">
      <iframe id="pattern-maker" src="./pattern-maker/index.html" width="100%" height="600px"></iframe>
      <span class="close">&times;</span>
    </div>
  </div>

  <div id="board" class="modal">
    <!-- Modal content -->
    <div class="board-content border-wrapper">
      <div class="board-control">
        <button class="btn" name="sell-all">Sell All</button>
      </div>
      <div class="object-list"></div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.2/axios.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.2/p5.min.js" integrity="sha512-eu9vkh+EbAsW3fMmPTj/DP5W3UegIdu0Z/OABMocvoofx43MYBkcQ9hRIVxZndV1vcCYQwBg+U1PkWl04TD0Jg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.4/addons/p5.sound.js" integrity="sha512-TU9AWtV5uUZPX8dbBAH8NQF1tSdigPRRT82vllAQ1Ke28puiqLA6ZVKxtUGlgrH6yWFnkKy+sE6luNEGH9ar0A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="./utils/coroutine.js"></script>
  <script src="./utils/partial.js"></script>
  <script src="../patterns.js"></script>
  <script src="./assets/scripts/button.js"></script>
  <script src="../evolution.js"></script>
  <script src="../bug.js"></script>
  <script src="../flower.js"></script>
  <script src="../route.js"></script>
  <script src="../farm.js"></script>
  <script src="../control-panel.js"></script>
  <script src="../sketch.js"></script>
  <script src="./utils/draw.js"></script>
  <script src="./utils/api.js"></script>
  <script src="./utils/setup.js"></script>
  <script src="./assets/scripts/modal.js"></script>
  <script src="./assets/scripts/board.js"></script>
  <script>
    document.addEventListener('contextmenu', event => event.preventDefault());

    const btnshow = document.getElementById("btn-show");
    const objcvs = document.getElementById("object-render-canvas");
    const patterncvs = document.getElementById("bug-pattern-canvas");
    const objctx = objcvs.getContext("2d");
    objctx.fillStyle = "#ffffff";
    objctx.strokeStyle = "#000000";
    objctx.fillRect(0, 0, 50, 50);

    function show() {
      const flowers = farm.objects.filter(obj => obj instanceof Flower);
      if (flowers.length > 1) {
        if (btnshow.innerHTML === "Stop The Show") { // stop the show
          btnshow.innerHTML = "Start The Marching Show!!!";
          farm.mode = "play";
          farm.route.stop();
          farm.route = null;
        } else { // start the show
          btnshow.innerHTML = "Stop The Show";
          farm.mode = "show";
          farm.route = new Route(farm.colony, flowers);
          farm.route.start();
        }
      }
    }

    function sellABug() {
      if (farm.colony.length === 1) return;

      farm.colony.forEach((bug, index) => {
        if (bug === selectedObj) {
          farm.colony.splice(index, 1);
        }
      });
    }
  </script>
</body>

</html>